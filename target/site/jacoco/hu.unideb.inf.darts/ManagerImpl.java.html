<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ManagerImpl.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Darts</a> &gt; <a href="index.source.html" class="el_package">hu.unideb.inf.darts</a> &gt; <span class="el_source">ManagerImpl.java</span></div><h1>ManagerImpl.java</h1><pre class="source lang-java linenums">
/**
 * hu.unideb.inf.darts csomag magában tartalmazza a működéshez szükséges fájlokat.
 */
package hu.unideb.inf.darts;

import org.slf4j.LoggerFactory;

/**
 * A játékot levezető osztály.
 * @author Ak
 */
<span class="fc" id="L13">public class ManagerImpl implements Manager {</span>
<span class="fc" id="L14">    private static final org.slf4j.Logger logger = LoggerFactory.getLogger(ManagerImpl.class);</span>
<span class="fc" id="L15">    static Darts darts = new Darts();</span>
<span class="fc" id="L16">    static User player1 = new User(&quot;A&quot;);</span>
<span class="fc" id="L17">    static User player2 = new User(&quot;B&quot;);</span>

<span class="fc" id="L19">    private int p1Counter = 1;</span>
<span class="fc" id="L20">    private int p2Counter = 5;</span>
<span class="fc" id="L21">    private double op1 = 0.3;</span>
<span class="fc" id="L22">    private double op2 = 0.2;</span>
<span class="fc" id="L23">    private int num1 = 0, num2 = 0, num3 = 0;</span>
<span class="fc" id="L24">    private int num4 = 0, num5 = 0, num6 = 0;</span>
<span class="fc" id="L25">    private boolean win = false;</span>

<span class="fc" id="L27">    private static int winner1 = 0;</span>
<span class="fc" id="L28">    private static int winner2 = 0;</span>
<span class="fc" id="L29">    private static int div1 = 0;</span>
<span class="fc" id="L30">    private static int div2 = 0;</span>
<span class="fc" id="L31">    private static int sum1 = 0;</span>
<span class="fc" id="L32">    private static int sum2 = 0;</span>
<span class="fc" id="L33">    private static int highScore1 = 0;</span>
<span class="fc" id="L34">    private static int highScore2 = 0;</span>

    @Override
    public void setPlayer(String playerOptions,User player1, User player2,Darts darts) {
<span class="fc" id="L38">        logger.info(&quot;Kezdő játékos beállítva&quot;);</span>
<span class="fc bfc" id="L39" title="All 2 branches covered.">        if (playerOptions.equals(&quot;Player1&quot;)) {</span>
<span class="fc" id="L40">            darts.setPlayer1(player1);</span>
<span class="fc" id="L41">            darts.setPlayer2(player2);</span>
        } else {
<span class="fc" id="L43">            darts.setPlayer1(player2);</span>
<span class="fc" id="L44">            darts.setPlayer2(player1);</span>
        }
<span class="fc" id="L46">    }</span>

    @Override
    public void options(String scoreOptions,Darts darts) {
<span class="fc" id="L50">        logger.info(&quot;Kezdő pontszám: &quot;+ scoreOptions);</span>
<span class="fc" id="L51">        darts.setGameMode(scoreOptions);</span>
<span class="fc" id="L52">        darts.getPlayer1().setScore(Integer.parseInt(scoreOptions));</span>
<span class="fc" id="L53">        darts.getPlayer2().setScore(Integer.parseInt(scoreOptions));</span>
<span class="fc" id="L54">    }</span>

    @Override
    public void setLeg(String legs,Darts darts) {
<span class="fc" id="L58">        logger.info(&quot;Legek száma: &quot;+legs);</span>
<span class="fc" id="L59">        darts.setLegs(Integer.parseInt(legs));</span>
<span class="fc" id="L60">    }</span>

    @Override
    public void calc(int num,Darts darts) {

<span class="pc bpc" id="L65" title="1 of 2 branches missed.">        if (!win) {</span>
<span class="fc bfc" id="L66" title="All 2 branches covered.">            if (p1Counter &lt; 4) {</span>

<span class="fc bfc" id="L68" title="All 2 branches covered.">                if (p1Counter == 1) {</span>
<span class="fc" id="L69">                    num1 = num;</span>
                }
<span class="fc bfc" id="L71" title="All 2 branches covered.">                if (p1Counter == 2) {</span>
<span class="fc" id="L72">                    num2 = num;</span>
                }
<span class="fc bfc" id="L74" title="All 2 branches covered.">                if (p1Counter == 3) {</span>
<span class="fc" id="L75">                    num3 = num;</span>
                }
<span class="fc bfc" id="L77" title="All 2 branches covered.">                if (num == 0) {</span>
<span class="fc" id="L78">                    logger.info(&quot;1.Játékos 0-t dobott&quot;);</span>
                    /*darts.getPlayer1().setScore((darts.getPlayer1().getScore()) + num1 + num2 + num3);
                    zero();
                    p1Counter = 4;*/
<span class="fc" id="L82">                    p1Counter++;</span>
<span class="fc bfc" id="L83" title="All 2 branches covered.">                } else if (darts.getPlayer1().getScore() &gt;= num) {</span>
<span class="fc" id="L84">                    darts.getPlayer1().setScore((darts.getPlayer1().getScore()) - num);</span>
<span class="fc" id="L85">                    sum1 = sum1 + num;</span>
<span class="fc" id="L86">                    highScore1 = highScore1 + num;</span>
<span class="fc" id="L87">                    p1Counter++;</span>
                } else {
<span class="pc bpc" id="L89" title="1 of 2 branches missed.">                    if (darts.getPlayer1().getScore() &lt; num1) {</span>
<span class="nc" id="L90">                        darts.getPlayer1().setScore((darts.getPlayer1().getScore()));</span>
<span class="nc" id="L91">                        logger.info(&quot;1.Játékos túl dobott&quot;);</span>
                    }
<span class="pc bpc" id="L93" title="1 of 2 branches missed.">                    if (darts.getPlayer1().getScore() &lt; num2) {</span>
<span class="nc" id="L94">                        darts.getPlayer1().setScore((darts.getPlayer1().getScore()) + num1);</span>
<span class="nc" id="L95">                        logger.info(&quot;1.Játékos túl dobott&quot;);</span>
                    }
<span class="pc bpc" id="L97" title="1 of 2 branches missed.">                    if (darts.getPlayer1().getScore() &lt; num3) {</span>
<span class="fc" id="L98">                        darts.getPlayer1().setScore((darts.getPlayer1().getScore()) + num1 + num2);</span>
<span class="fc" id="L99">                        logger.info(&quot;1.Játékos túl dobott&quot;);</span>
                    }
<span class="fc" id="L101">                    zero();</span>
<span class="fc" id="L102">                    p1Counter = 4;</span>
                }
<span class="fc" id="L104">                win = win(darts);</span>
<span class="fc" id="L105">                div1++;</span>
            }
<span class="fc bfc" id="L107" title="All 2 branches covered.">            if (p2Counter &lt; 4) {</span>

<span class="fc bfc" id="L109" title="All 2 branches covered.">                if (p2Counter == 1) {</span>
<span class="fc" id="L110">                    num4 = num;</span>
                }
<span class="fc bfc" id="L112" title="All 2 branches covered.">                if (p2Counter == 2) {</span>
<span class="fc" id="L113">                    num5 = num;</span>
                }
<span class="fc bfc" id="L115" title="All 2 branches covered.">                if (p2Counter == 3) {</span>
<span class="fc" id="L116">                    num6 = num;</span>
                }
<span class="fc bfc" id="L118" title="All 2 branches covered.">                if (num == 0) {</span>
<span class="fc" id="L119">                    logger.info(&quot;2.Játékos 0-t dobott&quot;);</span>
                    /*darts.getPlayer2().setScore((darts.getPlayer2().getScore()) + num4 + num5 + num6);
                    zero();
                    p2Counter = 4;*/
<span class="fc" id="L123">                    p2Counter++;</span>
<span class="fc bfc" id="L124" title="All 2 branches covered.">                } else if (darts.getPlayer2().getScore() &gt;= num) {</span>
<span class="fc" id="L125">                    darts.getPlayer2().setScore((darts.getPlayer2().getScore()) - num);</span>
<span class="fc" id="L126">                    sum2 = sum2 + num;</span>
<span class="fc" id="L127">                    highScore2 = highScore2 + num;</span>
<span class="fc" id="L128">                    p2Counter++;</span>
                } else {
<span class="pc bpc" id="L130" title="1 of 2 branches missed.">                    if (darts.getPlayer2().getScore() &lt; num4) {</span>
<span class="nc" id="L131">                        darts.getPlayer2().setScore((darts.getPlayer2().getScore()));</span>
<span class="nc" id="L132">                        logger.info(&quot;2.Játékos túl dobott&quot;);</span>
                    }
<span class="pc bpc" id="L134" title="1 of 2 branches missed.">                    if (darts.getPlayer2().getScore() &lt; num5) {</span>
<span class="nc" id="L135">                        darts.getPlayer2().setScore((darts.getPlayer2().getScore()) + num4);</span>
<span class="nc" id="L136">                        logger.info(&quot;2.Játékos túl dobott&quot;);</span>
                    }
<span class="pc bpc" id="L138" title="1 of 2 branches missed.">                    if (darts.getPlayer2().getScore() &lt; num6) {</span>
<span class="fc" id="L139">                        darts.getPlayer2().setScore((darts.getPlayer2().getScore()) + num4 + num5);</span>
<span class="fc" id="L140">                        logger.info(&quot;2.Játékos túl dobott&quot;);</span>
                    }

<span class="fc" id="L143">                    zero();</span>
<span class="fc" id="L144">                    p2Counter = 4;</span>
                }
<span class="fc" id="L146">                win = win(darts);</span>
<span class="fc" id="L147">                div2++;</span>
            }
<span class="fc bfc" id="L149" title="All 2 branches covered.">            if (p1Counter == 4) {</span>
<span class="fc" id="L150">                op2 = 0.3;</span>
<span class="fc" id="L151">                op1 = 0.2;</span>
<span class="fc" id="L152">                p2Counter = 1;</span>
<span class="fc" id="L153">                p1Counter = 5;</span>
<span class="fc bfc" id="L154" title="All 2 branches covered.">                if (darts.getPlayer1().getHighScore() &lt; highScore1) {</span>
<span class="fc" id="L155">                    darts.getPlayer1().setHighScore(highScore1);</span>
                }
<span class="pc bpc" id="L157" title="1 of 4 branches missed.">                if (highScore1 &gt;= 100 &amp;&amp; highScore1 &lt; 140) {</span>
<span class="nc" id="L158">                    darts.getPlayer1().setCounter3(darts.getPlayer1().getCounter3() + 1);</span>
<span class="nc" id="L159">                    logger.info(&quot;1.Játékos 100 felett dobott&quot;);</span>
                }
<span class="pc bpc" id="L161" title="1 of 4 branches missed.">                if (highScore1 &gt;= 140 &amp;&amp; highScore1 &lt; 180) {</span>
<span class="nc" id="L162">                    darts.getPlayer1().setCounter2(darts.getPlayer1().getCounter2() + 1);</span>
<span class="nc" id="L163">                    logger.info(&quot;1.Játékos 140 felett dobott&quot;);</span>
                }
<span class="pc bpc" id="L165" title="1 of 2 branches missed.">                if (highScore1 == 180) {</span>
<span class="nc" id="L166">                    darts.getPlayer1().setCounter1(darts.getPlayer1().getCounter1() + 1);</span>
<span class="nc" id="L167">                    logger.info(&quot;1.Játékos 180-at dobott&quot;);</span>
                }
<span class="fc" id="L169">                highScore1 = 0;</span>
<span class="fc" id="L170">                highScore2 = 0;</span>
<span class="fc" id="L171">                zero();</span>
            }
<span class="fc bfc" id="L173" title="All 2 branches covered.">            if (p2Counter == 4) {</span>
<span class="fc" id="L174">                op1 = 0.3;</span>
<span class="fc" id="L175">                op2 = 0.2;</span>
<span class="fc" id="L176">                p1Counter = 1;</span>
<span class="fc" id="L177">                p2Counter = 5;</span>
<span class="pc bpc" id="L178" title="1 of 2 branches missed.">                if (darts.getPlayer2().getHighScore() &lt; highScore2) {</span>
<span class="fc" id="L179">                    darts.getPlayer2().setHighScore(highScore2);</span>
                }
<span class="pc bpc" id="L181" title="1 of 4 branches missed.">                if (highScore2 &gt;= 100 &amp;&amp; highScore2 &lt; 140) {</span>
<span class="nc" id="L182">                    darts.getPlayer2().setCounter3(darts.getPlayer2().getCounter3() + 1);</span>
<span class="nc" id="L183">                    logger.info(&quot;2.Játékos 100 felett dobott&quot;);</span>
                }
<span class="pc bpc" id="L185" title="1 of 4 branches missed.">                if (highScore2 &gt;= 140 &amp;&amp; highScore2 &lt; 180) {</span>
<span class="nc" id="L186">                    darts.getPlayer2().setCounter2(darts.getPlayer2().getCounter2() + 1);</span>
<span class="nc" id="L187">                    logger.info(&quot;2.Játékos 140 felett dobott&quot;);</span>
                }
<span class="pc bpc" id="L189" title="1 of 2 branches missed.">                if (highScore2 == 180) {</span>
<span class="nc" id="L190">                    darts.getPlayer2().setCounter1(darts.getPlayer2().getCounter1() + 1);</span>
<span class="nc" id="L191">                    logger.info(&quot;2.Játékos 180-at dobott&quot;);</span>
                }
<span class="fc" id="L193">                highScore1 = 0;</span>
<span class="fc" id="L194">                highScore2 = 0;</span>
<span class="fc" id="L195">                zero();</span>
            }

            //win = win(darts.getPlayer1(), darts.getPlayer2());
        }
<span class="fc" id="L200">    }</span>

    @Override
    public void setResults(Darts darts) {
<span class="fc" id="L204">        logger.info(&quot;Végeredmények beállításra kerültek&quot;);</span>
<span class="fc" id="L205">        darts.getPlayer1().setMatches(darts.getPlayer1().getMatches() + 1);</span>
<span class="fc" id="L206">        darts.getPlayer2().setMatches(darts.getPlayer2().getMatches() + 1);</span>

<span class="pc bpc" id="L208" title="1 of 2 branches missed.">        if (darts.getPlayer1().getAvg() &gt; 0) {</span>
<span class="nc" id="L209">            darts.getPlayer1().setAvg(((darts.getPlayer1().getAvg() + ((sum1 / div1) * 3)) / 2));</span>
        } else {
<span class="fc" id="L211">            darts.getPlayer1().setAvg(((sum1 / div1)) * 3);</span>
        }
<span class="pc bpc" id="L213" title="1 of 2 branches missed.">        if (darts.getPlayer2().getAvg() &gt; 0) {</span>
<span class="nc" id="L214">            darts.getPlayer2().setAvg(((darts.getPlayer2().getAvg() + ((sum2 / div2) * 3)) / 2));</span>
        } else {
<span class="fc" id="L216">            darts.getPlayer2().setAvg(((sum2 / div2)) * 3);</span>
        }
<span class="fc" id="L218">        newGame();</span>
<span class="fc" id="L219">    }</span>

    private void zero() {
<span class="fc" id="L222">        num1 = 0;num2 = 0;num3 = 0;num4 = 0;num5 = 0;num6 = 0;</span>
<span class="fc" id="L223">    }</span>

    private void reSet() {
<span class="fc" id="L226">        logger.info(&quot;Új leg kezdődött&quot;);</span>
<span class="fc" id="L227">        darts.setLegs(darts.getLegs() - 1);</span>
<span class="fc" id="L228">        darts.getPlayer1().setScore(Integer.parseInt(darts.getGameMode()));</span>
<span class="fc" id="L229">        darts.getPlayer2().setScore(Integer.parseInt(darts.getGameMode()));</span>
<span class="fc" id="L230">    }</span>

    private void newGame() {
<span class="fc" id="L233">        zero();</span>
<span class="fc" id="L234">        p1Counter = 1;</span>
<span class="fc" id="L235">        p2Counter = 5;</span>
<span class="fc" id="L236">        div1 = 0;</span>
<span class="fc" id="L237">        div2 = 0;</span>
<span class="fc" id="L238">        sum1 = 0;</span>
<span class="fc" id="L239">        sum2 = 0;</span>
<span class="fc" id="L240">        highScore1 = 0;</span>
<span class="fc" id="L241">        highScore2 = 0;</span>
<span class="fc" id="L242">        win = false;</span>
<span class="fc" id="L243">        winner1 = 0;</span>
<span class="fc" id="L244">        winner2 = 0;</span>
<span class="fc" id="L245">        op1 = 0.3;</span>
<span class="fc" id="L246">        op2 = 0.2;</span>
<span class="fc" id="L247">    }</span>

    /**
     * Beállítja ki nyerte a leget, majd hogy ki nyerte a meccset.
     * @param darts egy darts
     * @return a meccs végét jelző értékkel.
     */
    public boolean win(Darts darts) {
<span class="pc bpc" id="L255" title="1 of 2 branches missed.">        if (darts.getLegs() != 1) {</span>
<span class="fc bfc" id="L256" title="All 2 branches covered.">            if (darts.getPlayer1().getScore() == 0) {</span>
<span class="fc" id="L257">                darts.getPlayer1().setWonMatches(darts.getPlayer1().getWonMatches() + 1);</span>
<span class="fc" id="L258">                op2 = 0.3;</span>
<span class="fc" id="L259">                op1 = 0.2;</span>
<span class="fc" id="L260">                p1Counter = 4;</span>
<span class="fc" id="L261">                zero();</span>
<span class="fc" id="L262">                reSet();</span>
<span class="fc" id="L263">                winner1++;</span>
<span class="fc" id="L264">                logger.info(&quot;1.Játékos nyerte a leget&quot;);</span>
            }
<span class="fc bfc" id="L266" title="All 2 branches covered.">            if (darts.getPlayer2().getScore() == 0) {</span>
<span class="fc" id="L267">                darts.getPlayer2().setWonMatches(darts.getPlayer2().getWonMatches() + 1);</span>
<span class="fc" id="L268">                op1 = 0.3;</span>
<span class="fc" id="L269">                op2 = 0.2;</span>
<span class="fc" id="L270">                p2Counter = 4;</span>
<span class="fc" id="L271">                zero();</span>
<span class="fc" id="L272">                reSet();</span>
<span class="fc" id="L273">                winner2++;</span>
<span class="fc" id="L274">                logger.info(&quot;2.Játékos nyerte a leget&quot;);</span>
            }
        } else {
<span class="nc bnc" id="L277" title="All 2 branches missed.">            if (darts.getPlayer1().getScore() == 0) {</span>
<span class="nc" id="L278">                darts.getPlayer1().setWonMatches(darts.getPlayer1().getWonMatches() + 1);</span>
<span class="nc" id="L279">                op2 = 0.3;</span>
<span class="nc" id="L280">                op1 = 0.2;</span>
<span class="nc" id="L281">                p1Counter = 4;</span>
<span class="nc" id="L282">                winner1++;</span>
<span class="nc" id="L283">                logger.info(&quot;1.Játékos nyert&quot;);</span>
<span class="nc" id="L284">                return true;</span>
            }
<span class="nc bnc" id="L286" title="All 2 branches missed.">            if (darts.getPlayer2().getScore() == 0) {</span>
<span class="nc" id="L287">                darts.getPlayer2().setWonMatches(darts.getPlayer2().getWonMatches() + 1);</span>
<span class="nc" id="L288">                op1 = 0.3;</span>
<span class="nc" id="L289">                op2 = 0.2;</span>
<span class="nc" id="L290">                p2Counter = 4;</span>
<span class="nc" id="L291">                winner2++;</span>
<span class="nc" id="L292">                logger.info(&quot;2.Játékos nyert&quot;);</span>
<span class="nc" id="L293">                return true;</span>
            }
        }
<span class="fc" id="L296">        return false;</span>
    }

    /**
     * Meccs végét jelző értékkel tér vissza.
     * @return {@code true} vagy {@code false}
     */
    public boolean getWin() {
<span class="fc" id="L304">        return win;</span>
    }

    /**
     * Visszaadja hogy az aktuális leget az első játékos nyerte.
     * @return {@code true} vagy {@code false}
     */
    public static int getWinner1() {
<span class="nc" id="L312">        return winner1;</span>
    }

    /**
     * Visszaadja hogy az aktuális leget a második játékos nyerte.
     * @return {@code true} vagy {@code false}
     */
    public static int getWinner2() {
<span class="nc" id="L320">        return winner2;</span>
    }

    /**
     * Visszaadja az adott {@code Darts}-ot.
     * @return a darts
     */
    public Darts getDarts() {
<span class="fc" id="L328">        return darts;</span>
    }

    /**
     * Visszaadja az első négyzet átlátszóságának értékével.
     * @return egy {@code double} érték
     */
    public double getOp1() {
<span class="fc" id="L336">        return op1;</span>
    }

    /**
     * Visszaadja a második négyzet átlátszóságának értékével.
     * @return egy {@code double} érték
     */
    public double getOp2() {
<span class="fc" id="L344">        return op2;</span>
    }

    /**
     * Visszaad egy {@code User}-t.
     * @return a játékos
     */
    public static User getPlayer1() {
<span class="fc" id="L352">        return player1;</span>
    }

    /**
     * Visszaad egy {@code User}-t.
     * @return a játékos
     */
    public static User getPlayer2() {
<span class="fc" id="L360">        return player2;</span>
    }

    /**
     * Beállítja a játék végét jelző értéket.
     * @param win {@code true} vagy {@code false}
     */
    public void setWin(boolean win) {
<span class="fc" id="L368">        this.win = win;</span>
<span class="fc" id="L369">    }</span>
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>